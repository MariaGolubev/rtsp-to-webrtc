# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –æ—Ç–∫–ª—é—á—ë–Ω–Ω—ã—Ö —Å–µ—Å—Å–∏–π

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

–¢–µ–ø–µ—Ä—å PeerConnection –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –Ω–∞:
- **Disconnected** - –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫–ª—é—á–∏–ª—Å—è
- **Failed** - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
- **Closed** - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `on_peer_connection_state_change`
2. –ö–æ–≥–¥–∞ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –º–µ–Ω—è–µ—Ç—Å—è –Ω–∞ `Disconnected`, `Failed` –∏–ª–∏ `Closed`:
   - –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
   - –°–µ—Å—Å–∏—è —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `peer_connections`
   - Video track —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ `video_tracks`
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –æ—á–∏—Å—Ç–∫–µ

## –ü—Ä–∏–º–µ—Ä—ã –ª–æ–≥–æ–≤

### –û–±—ã—á–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ
```
INFO webrtc::peer_connection: peer connection state changed: disconnected
INFO üîå Connection a1b2c3d4 state: Disconnected, cleaning up
INFO üßπ Session a1b2c3d4 auto-removed | Remaining: 0
```

### –ù–µ—É–¥–∞—á–Ω–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
```
INFO webrtc::peer_connection: peer connection state changed: failed
INFO üîå Connection xyz98765 state: Failed, cleaning up
INFO üßπ Session xyz98765 auto-removed | Remaining: 1
```

### –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
```
INFO webrtc::peer_connection: peer connection state changed: closed
INFO üîå Connection abc12345 state: Closed, cleaning up
INFO üßπ Session abc12345 auto-removed | Remaining: 2
```

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞

‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞** - –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–∑—ã–≤–∞—Ç—å DELETE
‚úÖ **–û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤** - video tracks –∏ peer connections —É–¥–∞–ª—è—é—Ç—Å—è —Å—Ä–∞–∑—É
‚úÖ **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** - –≤–∏–¥–Ω–æ –≤ –ª–æ–≥–∞—Ö, –∫–æ–≥–¥–∞ –∏ –ø–æ—á–µ–º—É —Å–µ—Å—Å–∏—è —É–¥–∞–ª–µ–Ω–∞
‚úÖ **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** - —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–∞–∂–µ –µ—Å–ª–∏ –∫–ª–∏–µ–Ω—Ç —Ä–µ–∑–∫–æ –æ—Ç–∫–ª—é—á–∏–ª—Å—è

## –°–æ—Å—Ç–æ—è–Ω–∏—è PeerConnection

- `New` - –Ω–æ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `Connecting` - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ
- `Connected` - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ ‚úÖ
- `Disconnected` - –≤—Ä–µ–º–µ–Ω–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**
- `Failed` - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**
- `Closed` - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ ‚Üí **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞**

## –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ

DELETE endpoint `/whep/resource/{id}` –≤—Å—ë –µ—â—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–π, –Ω–æ —Ç–µ–ø–µ—Ä—å –≤ –±–æ–ª—å—à–∏–Ω—Å—Ç–≤–µ —Å–ª—É—á–∞–µ–≤ –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
